# 依赖优化实施计划

**版本**：1.0.0  
**文档编号**：YYC-DEPO-20250703

## 一、背景与目标

本项目存在依赖混用、版本不一致、冗余依赖等问题，导致组件样式不统一、打包体积增大、维护成本提高。根据项目分析报告中的建议，我们将实施依赖优化，目标是：

1. 统一UI库，消除混用
2. 统一状态管理方案
3. 标准化依赖版本管理
4. 清理冗余依赖
5. 建立依赖策略规范

## 二、依赖优化方案

### 1. UI库选择与统一

#### 选择理由

- **shadcn/ui**：基于Radix UI构建，提供了可定制性高的组件，与Tailwind CSS集成良好，符合现代UI开发趋势
- 移除**@mui/material**和**antd**：避免多UI库混用导致的样式冲突和体积增大
- 保留并整合**radix-ui**组件：shadcn/ui基于Radix UI，可逐步替换现有使用

#### 实施步骤

1. 安装shadcn/ui依赖：`npx shadcn-ui@latest init`
2. 评估现有组件使用情况，优先替换高频使用的UI组件
3. 逐步移除@mui/material和antd依赖
4. 更新相关导入路径和组件使用方式
5. 调整样式以确保视觉一致性

### 2. 状态管理统一

#### 选择理由

- **Redux Toolkit**：对于复杂的状态管理场景提供了完整的解决方案，已有部分实现
- 保留**zustand**：对于简单组件的局部状态管理，可以作为Redux的补充
- 移除**redux-persist**：使用Redux Toolkit原生的持久化方案或自定义持久化逻辑

#### 实施步骤

1. 评估现有状态管理逻辑
2. 统一使用Redux Toolkit管理全局状态
3. 对于简单组件，使用zustand管理局部状态
4. 重构相关状态管理代码
5. 确保状态持久化功能正常

### 3. 图标库统一

#### 选择理由

- **lucide-react**：提供了丰富的图标集，风格统一，与shadcn/ui搭配良好
- 移除**@ant-design/icons**和**@mui/icons-material**：减少图标库冗余

#### 实施步骤

1. 建立图标映射表，将现有图标映射到lucide-react对应图标
2. 批量替换图标导入和使用
3. 对于缺失的图标，考虑自定义或选择替代方案
4. 移除废弃的图标库依赖

### 4. HTTP请求库统一

#### 选择理由

- **axios**：功能丰富，已广泛使用，提供拦截器等高级功能
- 移除原生fetch的混用：统一使用axios处理所有HTTP请求

#### 实施步骤

1. 封装axios实例，统一处理请求配置、拦截器等
2. 替换所有原生fetch使用为axios
3. 确保错误处理逻辑一致
4. 优化请求性能

### 5. 图表库统一

#### 选择理由

- **recharts**：React生态中流行的图表库，提供了丰富的图表类型和配置选项
- 移除**chart.js**：避免图表库混用导致的代码冗余

#### 实施步骤

1. 将chart.js图表转换为recharts实现
2. 统一图表样式和配置
3. 优化图表性能
4. 移除chart.js依赖

## 三、版本规范化

### 1. 版本锁定策略

- 为所有依赖指定具体版本号，移除"latest"标签
- 统一TypeScript版本，避免在dependencies和devDependencies中定义不同版本
- 更新eslint-config-next版本以匹配Next.js 15.2.4
- 确保React 19与所有相关依赖兼容

### 2. 依赖版本选择

以下是关键依赖的推荐版本：

```json
{
  "@reduxjs/toolkit": "^2.2.5",
  "next": "15.2.4",
  "react": "^19.0.0-rc.0",
  "react-dom": "^19.0.0-rc.0",
  "shadcn-ui": "^0.1.0",
  "radix-ui/react-*": "^1.0.0",
  "lucide-react": "^0.454.0",
  "axios": "^1.7.2",
  "recharts": "^2.12.7",
  "tailwindcss": "^3.4.4",
  "typescript": "^5.5.3"
}
```

## 四、依赖清理与维护

1. 使用`npx depcheck`工具识别并移除未使用的依赖
2. 使用`npm prune`清理多余的依赖文件
3. 建立依赖添加审核流程，避免随意添加新依赖
4. 创建依赖策略文档，明确各类型依赖的选择标准

## 五、实施时间线

1. **准备阶段**（1周）：制定详细计划，准备工具和资源
2. **依赖统一阶段**（2-3周）：完成UI库、状态管理、图标库等统一
3. **版本规范化阶段**（1周）：锁定依赖版本，解决版本冲突
4. **依赖清理阶段**（1周）：移除冗余依赖，优化项目结构
5. **验证与测试阶段**（1周）：确保所有功能正常，性能得到提升

## 六、风险与应对

1. **兼容性风险**：依赖版本升级可能导致代码不兼容
   - 应对：使用版本锁定，进行充分测试

2. **重构工作量**：大量代码需要重构
   - 应对：分阶段实施，优先处理核心功能

3. **性能影响**：优化过程中可能出现性能波动
   - 应对：持续监控性能指标，及时调整优化策略

4. **团队协作**：需要团队成员理解并遵循新的依赖策略
   - 应对：组织培训，创建详细文档，在代码审查中加强把关

## 七、验收标准

1. UI库统一为shadcn/ui，无@mui/material和antd依赖
2. 状态管理主要使用Redux Toolkit，局部状态使用zustand
3. 图标库统一为lucide-react
4. HTTP请求统一使用axios
5. 图表库统一为recharts
6. 所有依赖均指定具体版本，无"latest"标签
7. TypeScript版本统一
8. 项目构建成功，所有测试通过
9. 打包体积有明显减小
10. 项目运行性能有明显提升

---

**版本**：1.0.0  
**最后更新**：2025年7月3日  
**作者**：YYC 团队  
**保持代码健康，稳步前行！ 🌹**